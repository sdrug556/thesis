{"version":3,"file":"index.cjs","sources":["../src/utils/error.ts","../src/utils/has-property.ts","../src/utils/object.ts","../src/utils/to-array.ts","../src/locator/utils.ts","../src/locator/async.ts","../src/loader/utils.ts","../src/loader/file-type/script/utils.ts","../src/loader/file-type/script/async.ts","../src/loader/file-type/script/sync.ts","../src/loader/file-type/json.ts","../src/loader/module.ts","../src/locator/sync.ts","../src/utils/file-name.ts"],"sourcesContent":["/*\n * Copyright (c) 2022.\n * Author Peter Placzek (tada5hi)\n * For the full copyright and license information,\n * view the LICENSE file that was distributed with this source code.\n */\n\n/* istanbul ignore next */\nexport function handleFileLoadError(e: unknown) : void {\n    if (e instanceof Error) {\n        throw e;\n    }\n\n    if (typeof e === 'string') {\n        throw new Error(e);\n    }\n\n    throw new Error('Cannot determine file loading error.');\n}\n","export function hasOwnProperty<X extends Record<string, any>, Y extends PropertyKey>(obj: X, prop: Y): obj is X & Record<Y, unknown> {\n    return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nexport function hasStringProperty<X extends Record<string, any>, Y extends PropertyKey>(obj: X, prop: Y): obj is X & Record<Y, string> {\n    return hasOwnProperty(obj, prop) && typeof obj[prop] === 'string';\n}\n","/*\n * Copyright (c) 2022.\n * Author Peter Placzek (tada5hi)\n * For the full copyright and license information,\n * view the LICENSE file that was distributed with this source code.\n */\n\nexport function isObject(item: unknown) : item is Record<string, any> {\n    return (\n        !!item &&\n        typeof item === 'object' &&\n        !Array.isArray(item)\n    );\n}\n","/*\n * Copyright (c) 2022.\n * Author Peter Placzek (tada5hi)\n * For the full copyright and license information,\n * view the LICENSE file that was distributed with this source code.\n */\n\nexport function toArray(input: string | string[]) : string[] {\n    return Array.isArray(input) ? input : [input];\n}\n","/*\n * Copyright (c) 2022.\n * Author Peter Placzek (tada5hi)\n * For the full copyright and license information,\n * view the LICENSE file that was distributed with this source code.\n */\n\nimport path from 'node:path';\nimport { LocatorInfo, LocatorOptions } from './type';\nimport { toArray } from '../utils';\n\nexport function buildLocatorOptions(options?: Partial<LocatorOptions>) : LocatorOptions {\n    options = options || {};\n\n    options.path = options.path || [];\n    options.path = toArray(options.path);\n    if (options.path.length === 0) {\n        options.path.push(process.cwd());\n    }\n\n    options.ignore ??= [];\n\n    return options as LocatorOptions;\n}\n\nexport function pathToLocatorInfo(\n    input: string,\n    skipResolve?: boolean,\n) : LocatorInfo {\n    if (!skipResolve && !path.isAbsolute(input)) {\n        input = path.resolve(process.cwd(), input);\n    }\n\n    const info = path.parse(input);\n\n    return {\n        path: info.dir.split('/').join(path.sep),\n        name: info.name,\n        extension: info.ext,\n    };\n}\n","/*\n * Copyright (c) 2022.\n * Author Peter Placzek (tada5hi)\n * For the full copyright and license information,\n * view the LICENSE file that was distributed with this source code.\n */\n\nimport glob from 'glob';\nimport { promisify } from 'node:util';\nimport { LocatorInfo, LocatorOptions } from './type';\nimport { buildLocatorOptions, pathToLocatorInfo } from './utils';\n\nconst globAsync = promisify(glob);\n\nexport async function locateFiles(\n    pattern: string | string[],\n    options?: Partial<LocatorOptions>,\n) : Promise<LocatorInfo[]> {\n    options = buildLocatorOptions(options);\n\n    const patterns = Array.isArray(pattern) ?\n        pattern :\n        [pattern];\n\n    const items : LocatorInfo[] = [];\n\n    for (let i = 0; i < patterns.length; i++) {\n        for (let j = 0; j < (options as LocatorOptions).path.length; j++) {\n            const files = await globAsync(patterns[i] as string, {\n                absolute: true,\n                cwd: (options as LocatorOptions).path[j],\n                nodir: true,\n                ignore: options.ignore,\n            });\n\n            for (let k = 0; k < files.length; k++) {\n                items.push(pathToLocatorInfo(files[k] as string, true));\n            }\n        }\n    }\n\n    return items;\n}\n\nexport async function locateFile(\n    pattern: string | string[],\n    options?: Partial<LocatorOptions>,\n) : Promise<LocatorInfo | undefined> {\n    options = buildLocatorOptions(options);\n\n    const patterns = Array.isArray(pattern) ?\n        pattern :\n        [pattern];\n\n    for (let i = 0; i < patterns.length; i++) {\n        for (let j = 0; j < (options as LocatorOptions).path.length; j++) {\n            const files = await globAsync(patterns[i] as string, {\n                absolute: true,\n                cwd: (options as LocatorOptions).path[j],\n                nodir: true,\n                ignore: options.ignore,\n            });\n\n            const element = files.shift();\n            if (element) {\n                return pathToLocatorInfo(element, true);\n            }\n        }\n    }\n\n    return undefined;\n}\n","/*\n * Copyright (c) 2022.\n * Author Peter Placzek (tada5hi)\n * For the full copyright and license information,\n * view the LICENSE file that was distributed with this source code.\n */\n\nimport path from 'node:path';\nimport { LocatorInfo } from '../locator';\n\nexport function buildLoaderFilePath(info: LocatorInfo, withExtension?: boolean) {\n    if (withExtension) {\n        return path.join(info.path, info.name) + info.extension;\n    }\n\n    return path.join(info.path, info.name);\n}\n","/*\n * Copyright (c) 2022.\n * Author Peter Placzek (tada5hi)\n * For the full copyright and license information,\n * view the LICENSE file that was distributed with this source code.\n */\n\nimport { BaseError } from 'ebec';\nimport { hasOwnProperty } from '../../../utils';\nimport { LoaderFilterFn, ScriptFileExportItem } from './type';\n\nexport function getExportItem(\n    data: Record<string, any>,\n    filterFn?: LoaderFilterFn,\n) : ScriptFileExportItem {\n    if (filterFn) {\n        const keys = Object.keys(data);\n        for (let i = 0; i < keys.length; i++) {\n            if (filterFn(keys[i] as string, data[keys[i] as string])) {\n                return {\n                    key: keys[i] as string,\n                    value: data[keys[i] as string],\n                };\n            }\n        }\n\n        throw new BaseError('Cannot find specific module export.');\n    }\n\n    return {\n        key: 'default',\n        value: hasOwnProperty(data, 'default') ? data.default : data,\n    };\n}\n","/*\n * Copyright (c) 2022.\n * Author Peter Placzek (tada5hi)\n * For the full copyright and license information,\n * view the LICENSE file that was distributed with this source code.\n */\n\nimport { BaseError } from 'ebec';\nimport { pathToFileURL } from 'node:url';\nimport { LocatorInfo, pathToLocatorInfo } from '../../../locator';\nimport {\n    handleFileLoadError, hasStringProperty, isObject,\n} from '../../../utils';\nimport { buildLoaderFilePath } from '../../utils';\nimport { LoaderFilterFn, ScriptFileExportItem, ScriptFileLoadOptions } from './type';\nimport { getExportItem } from './utils';\n\nexport async function loadScriptFile(\n    data: LocatorInfo | string,\n    options?: ScriptFileLoadOptions,\n) : Promise<unknown> {\n    let locatorInfo : LocatorInfo;\n\n    if (typeof data === 'string') {\n        locatorInfo = pathToLocatorInfo(data);\n    } else {\n        locatorInfo = data;\n    }\n\n    options = options || {};\n\n    let filePath = buildLoaderFilePath(locatorInfo, options.withExtension);\n    if (options.withFilePrefix) {\n        filePath = pathToFileURL(filePath).href;\n    }\n\n    try {\n        return await import(filePath);\n    } catch (e) {\n        /* istanbul ignore next */\n        if (\n            isObject(e) &&\n            hasStringProperty(e, 'code')\n        ) {\n            if (\n                !options.withExtension &&\n                (\n                    e.code === 'ERR_MODULE_NOT_FOUND' ||\n                    e.code === 'MODULE_NOT_FOUND'\n                )\n            ) {\n                return loadScriptFile(locatorInfo, {\n                    ...options,\n                    withExtension: true,\n                });\n            }\n\n            if (\n                !options.withFilePrefix &&\n                (\n                    e.code === 'ERR_UNSUPPORTED_ESM_URL_SCHEME' ||\n                    e.code === 'UNSUPPORTED_ESM_URL_SCHEME'\n                )\n            ) {\n                return loadScriptFile(locatorInfo, {\n                    ...options,\n                    withFilePrefix: true,\n                });\n            }\n\n            throw new BaseError({\n                code: e.code,\n                message: hasStringProperty(e, 'message') ? e.message : undefined,\n                stack: hasStringProperty(e, 'stack') ? e.stack : undefined,\n            });\n        }\n\n        /* istanbul ignore next */\n        return handleFileLoadError(e);\n    }\n}\n\nexport async function loadScriptFileExport(\n    data: LocatorInfo | string,\n    filterFn?: LoaderFilterFn,\n) : Promise<ScriptFileExportItem> {\n    const output = await loadScriptFile(data);\n\n    if (typeof output === 'object' && !!output) {\n        return getExportItem(output, filterFn);\n    }\n\n    throw new BaseError('Cannot extract specific module export');\n}\n","/*\n * Copyright (c) 2022.\n * Author Peter Placzek (tada5hi)\n * For the full copyright and license information,\n * view the LICENSE file that was distributed with this source code.\n */\n\nimport { BaseError } from 'ebec';\nimport { LoaderFilterFn, ScriptFileExportItem, ScriptFileLoadOptions } from './type';\nimport { getExportItem } from './utils';\nimport { LocatorInfo, pathToLocatorInfo } from '../../../locator';\nimport { buildLoaderFilePath } from '../../utils';\nimport {\n    handleFileLoadError, hasStringProperty, isObject,\n} from '../../../utils';\n\nexport function loadScriptFileSync(\n    data: LocatorInfo | string,\n    options?: ScriptFileLoadOptions,\n) : unknown {\n    let locatorInfo : LocatorInfo;\n\n    if (typeof data === 'string') {\n        locatorInfo = pathToLocatorInfo(data);\n    } else {\n        locatorInfo = data;\n    }\n\n    options = options || {};\n\n    const filePath = buildLoaderFilePath(locatorInfo, options.withExtension);\n\n    try {\n        // eslint-disable-next-line global-require,import/no-dynamic-require\n        return require(filePath);\n    } catch (e) {\n        /* istanbul ignore next */\n        if (\n            isObject(e) &&\n            hasStringProperty(e, 'code')\n        ) {\n            if (\n                !options.withExtension &&\n                (\n                    e.code === 'ERR_MODULE_NOT_FOUND' ||\n                    e.code === 'MODULE_NOT_FOUND'\n                )\n            ) {\n                return loadScriptFileSync(locatorInfo, {\n                    ...options,\n                    withExtension: true,\n                });\n            }\n\n            throw new BaseError({\n                code: e.code,\n                message: hasStringProperty(e, 'message') ? e.message : undefined,\n                stack: hasStringProperty(e, 'stack') ? e.stack : undefined,\n            });\n        }\n\n        return handleFileLoadError(e);\n    }\n}\n\nexport function loadScriptFileExportSync(\n    data: LocatorInfo | string,\n    filterFn?: LoaderFilterFn,\n) : ScriptFileExportItem {\n    const output = loadScriptFileSync(data);\n\n    if (typeof output === 'object' && !!output) {\n        return getExportItem(output, filterFn);\n    }\n\n    throw new BaseError('Cannot extract specific module export');\n}\n","/*\n * Copyright (c) 2022-2022.\n * Author Peter Placzek (tada5hi)\n * For the full copyright and license information,\n * view the LICENSE file that was distributed with this source code.\n */\n\nimport fs from 'node:fs';\nimport path from 'node:path';\nimport { LocatorInfo } from '../../locator';\nimport { handleFileLoadError } from '../../utils';\nimport { buildLoaderFilePath } from '../utils';\n\nexport async function loadJsonFile(input: LocatorInfo | string) : Promise<unknown> {\n    let filePath : string;\n\n    if (typeof input === 'string') {\n        filePath = path.isAbsolute(input) ? input : path.resolve(process.cwd(), input);\n    } else {\n        filePath = buildLoaderFilePath(input, true);\n    }\n\n    try {\n        const file = await fs.promises.readFile(filePath);\n        return JSON.parse(file.toString('utf-8'));\n    } catch (e) {\n        return handleFileLoadError(e);\n    }\n}\n\nexport function loadJsonFileSync(input: LocatorInfo | string) : unknown {\n    let filePath : string;\n\n    if (typeof input === 'string') {\n        filePath = path.isAbsolute(input) ? input : path.resolve(process.cwd(), input);\n    } else {\n        filePath = buildLoaderFilePath(input, true);\n    }\n\n    try {\n        const file = fs.readFileSync(filePath);\n        return JSON.parse(file.toString('utf-8'));\n    } catch (e) {\n        return handleFileLoadError(e);\n    }\n}\n","/*\n * Copyright (c) 2022.\n * Author Peter Placzek (tada5hi)\n * For the full copyright and license information,\n * view the LICENSE file that was distributed with this source code.\n */\n\nimport { LocatorInfo, pathToLocatorInfo } from '../locator';\nimport {\n    loadJsonFile,\n    loadJsonFileSync,\n    loadScriptFile,\n    loadScriptFileSync,\n} from './file-type';\n\nexport async function loadFile(input: LocatorInfo | string) : Promise<unknown> {\n    let info : LocatorInfo;\n    if (typeof input === 'string') {\n        info = pathToLocatorInfo(input);\n    } else {\n        info = input;\n    }\n\n    if (info.extension === '.json') {\n        return loadJsonFile(info);\n    }\n\n    return loadScriptFile(info);\n}\n\nexport function loadFileSync(input: LocatorInfo | string) : unknown {\n    let info : LocatorInfo;\n    if (typeof input === 'string') {\n        info = pathToLocatorInfo(input);\n    } else {\n        info = input;\n    }\n\n    if (info.extension === '.json') {\n        return loadJsonFileSync(info);\n    }\n\n    return loadScriptFileSync(info);\n}\n","/*\n * Copyright (c) 2022.\n * Author Peter Placzek (tada5hi)\n * For the full copyright and license information,\n * view the LICENSE file that was distributed with this source code.\n */\n\nimport glob from 'glob';\nimport { LocatorInfo, LocatorOptions } from './type';\nimport { buildLocatorOptions, pathToLocatorInfo } from './utils';\n\nexport function locateFilesSync(\n    pattern: string | string[],\n    options?: Partial<LocatorOptions>,\n) : LocatorInfo[] {\n    options = buildLocatorOptions(options);\n\n    const patterns = Array.isArray(pattern) ?\n        pattern :\n        [pattern];\n\n    const items : LocatorInfo[] = [];\n\n    for (let i = 0; i < patterns.length; i++) {\n        for (let j = 0; j < (options as LocatorOptions).path.length; j++) {\n            const files = glob.sync(patterns[i] as string, {\n                absolute: true,\n                cwd: (options as LocatorOptions).path[j],\n                nodir: true,\n                ignore: options.ignore,\n            });\n\n            for (let k = 0; k < files.length; k++) {\n                items.push(pathToLocatorInfo(files[k] as string, true));\n            }\n        }\n    }\n\n    return items;\n}\n\nexport function locateFileSync(\n    pattern: string | string[],\n    options?: Partial<LocatorOptions>,\n) : LocatorInfo | undefined {\n    options = buildLocatorOptions(options);\n\n    const patterns = Array.isArray(pattern) ?\n        pattern :\n        [pattern];\n\n    for (let i = 0; i < patterns.length; i++) {\n        for (let j = 0; j < (options as LocatorOptions).path.length; j++) {\n            const files = glob.sync(patterns[i] as string, {\n                absolute: true,\n                cwd: (options as LocatorOptions).path[j],\n                nodir: true,\n                ignore: options.ignore,\n            });\n\n            const element = files.shift();\n            if (element) {\n                return pathToLocatorInfo(element, true);\n            }\n        }\n    }\n\n    return undefined;\n}\n","/*\n * Copyright (c) 2022.\n * Author Peter Placzek (tada5hi)\n * For the full copyright and license information,\n * view the LICENSE file that was distributed with this source code.\n */\n\nexport function removeFileNameExtension(\n    input: string,\n    extensions?: string[],\n) {\n    if (input.includes('.')) {\n        const position = input.lastIndexOf('.');\n        const extension = input.substring(\n            position,\n            input.length,\n        );\n\n        if (\n            typeof extensions === 'undefined' ||\n            extensions.indexOf(extension) !== -1\n        ) {\n            input = input.substring(0, position);\n        }\n    }\n\n    return input;\n}\n"],"names":["handleFileLoadError","e","Error","hasOwnProperty","obj","prop","Object","prototype","call","hasStringProperty","isObject","item","_typeof","Array","isArray","toArray","input","buildLocatorOptions","options","_options","_options$ignore","path","length","push","process","cwd","ignore","pathToLocatorInfo","skipResolve","isAbsolute","resolve","info","parse","dir","split","join","sep","name","extension","ext","globAsync","promisify","glob","_locateFiles","_asyncToGenerator","_regeneratorRuntime","mark","_callee","pattern","patterns","items","i","j","files","k","wrap","_context","prev","next","absolute","nodir","sent","abrupt","stop","apply","this","arguments","_locateFile","_callee2","element","_context2","shift","undefined","buildLoaderFilePath","withExtension","getExportItem","data","filterFn","keys","key","value","BaseError","loadScriptFile","_x","_x2","_loadScriptFile","locatorInfo","filePath","withFilePrefix","pathToFileURL","href","import","t0","code","_objectSpread","message","stack","_loadScriptFileExport","output","loadScriptFileSync","require","loadJsonFile","_loadJsonFile","file","fs","promises","readFile","JSON","toString","loadJsonFileSync","readFileSync","_loadFile","_x3","_x4","sync","extensions","includes","position","lastIndexOf","substring","indexOf"],"mappings":"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"}